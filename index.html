<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D ‘±÷Ä’•’£’°’Ø’∂’°’µ’´’∂ ’∞’°’¥’°’Ø’°÷Ä’£</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117; /* ’è’´’•’¶’•÷Ä÷Ñ’´ ’¥’∏÷Ç’£ ÷Ü’∏’∂ */
            color: #e5e7eb;
            margin: 0;
            overflow: hidden; /* ‘π’°÷Ñ÷Å’∂’•’¨ ’∫’ø’ø’æ’∏’≤ ’£’∏’ø’´’∂’•÷Ä’® */
        }
        #info-box {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 10px 20px;
            background-color: rgba(22, 27, 34, 0.9); /* ’Ñ’∏÷Ç’£ ’Ø’´’Ω’°’©’°÷É’°’∂÷Å’´’Ø ÷Ü’∏’∂ */
            border-radius: 12px;
            border: 1px solid #30363d;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            text-align: center;
            z-index: 10;
            max-width: 90%;
            transition: all 0.3s ease;
        }
        #info-text {
            color: #ffcc00;
            font-size: 1.1rem;
            font-weight: 500;
        }
        canvas {
            display: block;
            width: 100vw;
            height: 100vh;
        }
        /* Style for the link button */
        #destruction-link {
            background-color: #dc2626; /* Red-600 */
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.1s;
            cursor: pointer;
            margin-top: 10px;
            display: inline-block;
            box-shadow: 0 0 15px #f87171;
            text-decoration: none; /* ’Ä’≤’¥’°’∂ ’ø’•’Ω÷Ñ’® ’Ø’∏’≥’°’Ø’´ */
        }
        #destruction-link:hover {
            background-color: #ef4444; /* Red-500 */
            transform: scale(1.05);
        }
        /* New Sidebar Styles */
        #sidebar {
            position: fixed;
            top: 0;
            left: 0;
            height: 100%;
            width: 250px;
            background-color: rgba(13, 17, 23, 0.95); /* ’Ñ’∏÷Ç’£ ’Ø’´’Ω’°’©’°÷É’°’∂÷Å’´’Ø ÷Ü’∏’∂ */
            border-right: 1px solid #30363d;
            padding: 20px 10px;
            z-index: 15;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.5);
            transition: transform 0.3s ease;
        }
        .planet-link {
            display: block;
            padding: 10px 15px;
            margin-bottom: 5px;
            border-radius: 8px;
            text-decoration: none;
            color: #c9d1d9;
            background-color: #161b22;
            transition: background-color 0.2s ease, color 0.2s ease;
            font-weight: 500;
            border: 1px solid #21262d;
        }
        .planet-link:hover {
            background-color: #21262d;
            color: #58a6ff;
        }
    </style>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        let app, db, auth;

        try {
            if (Object.keys(firebaseConfig).length > 0) {
                app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);

                // ’Ü’∏÷Ç’µ’∂’°’Ø’°’∂’°÷Å’¥’°’∂ ’Ø’°÷Ä’£’°’æ’∏÷Ä’∏÷Ç’¥
                if (initialAuthToken) {
                    signInWithCustomToken(auth, initialAuthToken).catch(e => console.error("Firebase Custom Auth failed:", e));
                } else {
                    signInAnonymously(auth).catch(e => console.error("Firebase Anonymous Auth failed:", e));
                }
            } else {
                console.warn("Firebase configuration is missing.");
            }
        } catch (error) {
            console.error("Firebase Initialization Error:", error);
        }
    </script>
</head>
<body>
    <div id="sidebar">
        <h2 class="text-xl font-bold text-white mb-4 border-b border-gray-700 pb-2">üî≠ ’Ñ’∏’¨’∏÷Ä’°’Ø’∂’•÷Ä ÷á ’Ä’≤’∏÷Ç’¥’∂’•÷Ä</h2>
        <div id="planet-links-container">
            </div>
    </div>

    <div id="info-box">
        <h1 class="text-2xl font-bold text-white mb-1">‘±÷Ä’•’£’°’Ø’∂’°’µ’´’∂ ’Ä’°’¥’°’Ø’°÷Ä’£’´ ’à÷Ç’Ω’∏÷Ç’¥’∂’°’Ω’´÷Ä’∏÷Ç’©’µ’∏÷Ç’∂</h1>
        <p id="info-text" class="text-sm mb-2">’ç’•’≤’¥’•÷Ñ ’¥’∏’¨’∏÷Ä’°’Ø’´ ’æ÷Ä’°’ù ’∞’•’ø÷Ñ÷Ä÷Ñ’´÷Ä ÷É’°’Ω’ø’•÷Ä ’´’¥’°’∂’°’¨’∏÷Ç ’∞’°’¥’°÷Ä÷â</p>
        <a href="wochnchacum.html" id="destruction-link">
            ‘≥’°’¨’°’Ø’ø’´’Ø’°’µ’´ ’à’π’∂’π’°÷Å’¥’°’∂ ‘ø’•’∂’ø÷Ä’∏’∂
        </a>
    </div>

    <script>
        let scene, camera, renderer, sun;
        let isDragging = false;
        let previousMousePosition = { x: 0, y: 0 };
        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();
        let initialPinchDistance = null;
        const SUN_RADIUS = 3;
        const ORBIT_LINE_COLOR = 0x404040;

        // ’Ñ’∏’¨’∏÷Ä’°’Ø’∂’•÷Ä’´ ’ø’æ’µ’°’¨’∂’•÷Ä ÷á ’∞’≤’∏÷Ç’¥’∂’•÷Ä’´ ÷Ñ’°÷Ä’ø’•’¶
        const SOLAR_SYSTEM = [
            // ‘±÷Ä÷á’® ’°’æ’•’¨’°÷Å÷Ä’•’¨ ’•’∂÷Ñ ’∏÷Ä’∫’•’Ω ’∞’°’ø’∏÷Ç’Ø ’ø’°÷Ä÷Ä
            { name: 'Sun', color: 0xffa500, radius: SUN_RADIUS, orbit: 0, speed: 0, armenianName: '‘±÷Ä’•’£’°’Ø', link: 'sun.html' },
            { name: 'Mercury', color: 0x8a8a8a, radius: 0.4, orbit: 8, speed: 0.020, armenianName: '’Ñ’•÷Ä’Ø’∏÷Ç÷Ä’´', link: 'mercury.html' },
            { name: 'Venus', color: 0xe8c784, radius: 0.7, orbit: 14, speed: 0.015, armenianName: '’é’•’∂’•÷Ä’°', link: 'venera.html' },
            { name: 'Earth', color: 0x0077ff, radius: 0.8, orbit: 20, speed: 0.010, armenianName: '‘µ÷Ä’Ø’´÷Ä', link: 'erkir.html' },
            { name: 'Mars', color: 0xc9582d, radius: 0.5, orbit: 28, speed: 0.008, armenianName: '’Ñ’°÷Ä’Ω', link: 'mars.html' },
            { name: 'Jupiter', color: 0xc8aa80, radius: 2.5, orbit: 45, speed: 0.005, armenianName: '’Ö’∏÷Ç’∫’´’ø’•÷Ä', link: 'yupiter.html' },
            { name: 'Saturn', color: 0xe0d4b9, radius: 2.0, orbit: 60, speed: 0.004, armenianName: '’ç’°’ø’∏÷Ç÷Ä’∂', link: 'saturn.html' },
            { name: 'Uranus', color: 0xafeeee, radius: 1.5, orbit: 75, speed: 0.003, armenianName: '’à÷Ç÷Ä’°’∂', link: 'uran.html' },
            { name: 'Neptune', color: 0x000080, radius: 1.4, orbit: 90, speed: 0.002, armenianName: '’Ü’•’∫’ø’∏÷Ç’∂', link: 'neptun.html' }
        ];

        let planetObjects = [];
        const infoTextEl = document.getElementById('info-text');

        function getAuthFilePath(filename) {
            return `./${filename}`;
        }

        function init() {
            // ’è’•’Ω’°÷Ä’°’∂’´ (Scene), ’è’•’Ω’°’≠÷Å’´’Ø’´ (Camera) ÷á ’å’•’∂’§’•÷Ä’•÷Ä’´ (Renderer) ’Ω’ø’•’≤’Æ’∏÷Ç’¥
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0d1117);
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 120;
            camera.position.y = 20;
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            // ‘±÷Ä÷á’´ ’Ω’ø’•’≤’Æ’∏÷Ç’¥
            const sunData = SOLAR_SYSTEM.find(p => p.name === 'Sun');
            const sunGeometry = new THREE.SphereGeometry(sunData.radius, 32, 32);
            const sunMaterial = new THREE.MeshPhongMaterial({
                color: sunData.color,
                emissive: sunData.color,
                emissiveIntensity: 0.8,
                shininess: 0
            });
            sun = new THREE.Mesh(sunGeometry, sunMaterial);
            scene.add(sun);
            sun.name = sunData.name;
            sun.link = sunData.link; // ’Ä’≤’∏÷Ç’¥’® ’∫’°’∞’•’¨ ‘±÷Ä÷á’´ ÷Ö’¢’µ’•’Ø’ø’´ ’æ÷Ä’°

            // ‘º’∏÷Ç’µ’Ω’•÷Ä’´ ’°’æ’•’¨’°÷Å’∏÷Ç’¥
            const sunLight = new THREE.PointLight(0xffffff, 4, 300);
            sunLight.position.set(0, 0, 0);
            scene.add(sunLight);
            const ambientLight = new THREE.AmbientLight(0x404040, 1);
            scene.add(ambientLight);

            // ’Ñ’∏’¨’∏÷Ä’°’Ø’∂’•÷Ä’´ ÷á ’∏÷Ç’≤’•’Æ÷Ä’•÷Ä’´ ’Ω’ø’•’≤’Æ’∏÷Ç’¥
            SOLAR_SYSTEM.filter(data => data.name !== 'Sun').forEach(data => {
                const pivot = new THREE.Object3D(); // ’ä’ø’ø’¥’°’∂ ’Ø’•’ø
                sun.add(pivot);

                const geometry = new THREE.SphereGeometry(data.radius, 32, 32);
                const material = new THREE.MeshPhongMaterial({ color: data.color, shininess: 10 });
                const planet = new THREE.Mesh(geometry, material);
                planet.position.x = data.orbit;
                planet.name = data.name; // ‘±’∂’∏÷Ç’∂’® ’Ø’°÷Ä÷á’∏÷Ä ’ß ’Ω’•’≤’¥’•’¨’∏÷Ç ’∞’°’¥’°÷Ä
                planet.link = data.link; // ’Ä’≤’∏÷Ç’¥’® ’∫’°’∞’•’¨ ’¥’∏’¨’∏÷Ä’°’Ø’´ ÷Ö’¢’µ’•’Ø’ø’´ ’æ÷Ä’°
                pivot.add(planet);

                const orbitGeometry = new THREE.TorusGeometry(data.orbit, 0.1, 16, 100);
                const orbitMaterial = new THREE.MeshBasicMaterial({ color: ORBIT_LINE_COLOR, transparent: true, opacity: 0.3 });
                const orbit = new THREE.Mesh(orbitGeometry, orbitMaterial);
                orbit.rotation.x = Math.PI / 2;
                sun.add(orbit);

                planetObjects.push({ pivot: pivot, mesh: planet, speed: data.speed, name: data.name, armenianName: data.armenianName, link: data.link });
            });

            // ‘ø’∏’≤’°’µ’´’∂ ’¥’•’∂’µ’∏÷Ç’´ ’¢’∏’æ’°’∂’§’°’Ø’∏÷Ç’©’µ’°’∂ ’£’•’∂’•÷Ä’°÷Å’∏÷Ç’¥
            generateSidebarLinks();

            // ‘ª÷Ä’°’§’°÷Ä’±’∏÷Ç’©’µ’∏÷Ç’∂’∂’•÷Ä’´ ’¨’Ω’∏’≤’∂’•÷Ä’´ ’°’æ’•’¨’°÷Å’∏÷Ç’¥
            document.addEventListener('mousedown', onMouseDown, false);
            document.addEventListener('mousemove', onMouseMove, false);
            document.addEventListener('mouseup', onMouseUp, false);
            document.addEventListener('wheel', onMouseWheel, false);
            document.addEventListener('touchstart', onTouchStart, false);
            document.addEventListener('touchmove', onTouchMove, false);
            document.addEventListener('touchend', onTouchEnd, false);
            window.addEventListener('resize', onWindowResize, false);
            renderer.domElement.addEventListener('click', onClick, false);

            animate();
        }

        // ‘ø’∏’≤’°’µ’´’∂ ’¥’•’∂’µ’∏÷Ç’´ ’∞’≤’∏÷Ç’¥’∂’•÷Ä’´ ’£’•’∂’•÷Ä’°÷Å’´’°’µ’´ ÷Ü’∏÷Ç’∂’Ø÷Å’´’°
        function generateSidebarLinks() {
            const container = document.getElementById('planet-links-container');
            SOLAR_SYSTEM.forEach(data => {
                const link = document.createElement('a');
                link.href = getAuthFilePath(data.link);
                link.className = 'planet-link';
                link.textContent = data.armenianName + ' (' + data.name + ')';
                // ’ï’£’ø’°’£’∏÷Ä’Æ’•’¨ link.dataset-’® ’Ø’°’¥ link.href-’®
                link.addEventListener('click', (e) => {
                    // e.preventDefault(); // ‘±’µ’Ω ’ø’∏’≤’® ’Ø’°÷Ä’∏’≤ ’ß ’™’°’¥’°’∂’°’Ø’°’æ’∏÷Ä’°’∫’•’Ω ’°’∂’ª’°’ø’æ’•’¨, ’∏÷Ä’∫’•’Ω’¶’´ ’∞’≤’∏÷Ç’¥’® ’°’∑’≠’°’ø’´
                    infoTextEl.textContent = `‘≤’•’º’∂’æ’∏÷Ç’¥ ’ß ${data.armenianName} ’ß’ª’®...`;
                    // window.location.href = getAuthFilePath(data.link); // ’à÷Ç’≤’°÷Ä’Ø’•’¨ ’ß’ª

                });
                container.appendChild(link);
            });
        }

        // ‘±’∂’´’¥’°÷Å’´’∏’∂ ÷Å’´’Ø’¨
        function animate() {
            requestAnimationFrame(animate);

            // ‘±÷Ä÷á’´ ’°’º’°’∂÷Å÷Ñ’°’µ’´’∂ ’∫’ø’∏÷Ç’µ’ø
            sun.rotation.y += 0.001;

            // ’Ñ’∏’¨’∏÷Ä’°’Ø’∂’•÷Ä’´ ’∫’ø’∏÷Ç’µ’ø’® ‘±÷Ä÷á’´ ’∑’∏÷Ç÷Ä’ª ÷á ’´÷Ä’•’∂÷Å ’°’º’°’∂÷Å÷Ñ’´ ’∑’∏÷Ç÷Ä’ª
            planetObjects.forEach(planetObj => {
                planetObj.pivot.rotation.y += planetObj.speed; // ’à÷Ç’≤’•’Æ÷Ä’°’µ’´’∂ ’∫’ø’∏÷Ç’µ’ø
                planetObj.mesh.rotation.y += 0.01; // ‘±’º’°’∂÷Å÷Ñ’°’µ’´’∂ ’∫’ø’∏÷Ç’µ’ø
            });

            renderer.render(scene, camera);
        }

        // ’ä’°’ø’∏÷Ç’∞’°’∂’´ ’π’°÷É’´ ÷É’∏÷É’∏’≠’¥’°’∂ ’¥’∑’°’Ø’∏÷Ç’¥
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        // ’è’•’Ω’°’≠÷Å’´’Ø’´ ’Ø’°’º’°’æ’°÷Ä’∏÷Ç’¥’® ’¥’Ø’∂’´’Ø’∏’æ (Rotation)
        function onMouseDown(event) {
            // ’ç’ø’∏÷Ç’£’•’¨, ’∏÷Ä ’¥’Ø’∂’´’Ø’´ ’°’ª ’Ø’∏’≥’°’Ø’® ’π’ß (0=’±’°’≠, 1=’¥’´’ª’´’∂, 2=’°’ª)
            if (event.button === 0) {
                 // ’â’©’∏÷Ç’µ’¨’°’ø÷Ä’•’¨ ’∫’ø’ø’•’¨, ’•’©’• ’Ω’•’≤’¥’æ’°’Æ ’ß ’Ø’∏’≤’°’µ’´’∂ ’¥’•’∂’µ’∏÷Ç’∂
                if (event.clientX > 250) { // 250px-’® ’¥’•’∂’µ’∏÷Ç’´ ’¨’°’µ’∂’∏÷Ç’©’µ’∏÷Ç’∂’∂ ’ß
                    isDragging = true;
                    previousMousePosition.x = event.clientX;
                    previousMousePosition.y = event.clientY;
                }
            }
        }

        function onMouseMove(event) {
            if (!isDragging) return;

            const deltaX = event.clientX - previousMousePosition.x;
            const deltaY = event.clientY - previousMousePosition.y;

            // ’ä’ø’ø’•’¨ ’°’¥’¢’∏’≤’ª ’ø’•’Ω’°÷Ä’°’∂’®
            scene.rotation.y += deltaX * 0.005;
            scene.rotation.x += deltaY * 0.005;

            // ’ç’°’∞’¥’°’∂’°÷É’°’Ø’•’¨ X ’°’º’°’∂÷Å÷Ñ’´ ’∫’ø’∏÷Ç’µ’ø’®
            scene.rotation.x = Math.max(-Math.PI / 2, Math.min(Math.PI / 2, scene.rotation.x));

            previousMousePosition.x = event.clientX;
            previousMousePosition.y = event.clientY;
        }

        function onMouseUp(event) {
            isDragging = false;
        }

        // **’Ñ’Ø’∂’´’Ø’´ ’°’∂’´’æ’´ (Wheel) ’¥’∑’°’Ø’∏÷Ç’¥’ù ’¥’∏’ø’•÷Å’∂’•’¨’∏÷Ç/’∞’•’º’°÷Å’∂’•’¨’∏÷Ç ’∞’°’¥’°÷Ä (Zoom) - ‘≤‘±’ê‘µ‘º‘±’é’é‘±‘æ**
        function onMouseWheel(event) {
            event.preventDefault(); // ‘ø’°’∂’≠’•’¨ ’ß’ª’´ ’∏’¨’∏÷Ä’∏÷Ç’¥’®
            const zoomAmount = event.deltaY * 0.5; // 0.5-’® ’∂’∏÷Ä, ’°’æ’•’¨’´ ’¶’£’°’µ’∏÷Ç’∂ ’£’∏÷Ä’Æ’°’Ø’´÷Å’∂ ’ß
            camera.position.z += zoomAmount;

            // ’ç’°’∞’¥’°’∂’°÷É’°’Ø’•’¨ ’¶’∏÷Ç’¥’´ ’§’´’°’∫’°’¶’∏’∂’® (Zoom limits)
            camera.position.z = Math.max(5, Math.min(200, camera.position.z));
        }

        // ’ç’•’≤’¥’¥’°’∂ (Click) ’¥’∑’°’Ø’∏÷Ç’¥
        function onClick(event) {
            if (isDragging) {
                 // ‘µ’©’• ’°’µ’Ω ’∫’°’∞’´’∂ ÷Ñ’°÷Ä’∑ ’•’∂÷Ñ ’ø’æ’•’¨, ’π’∞’°’∑’æ’•’¨ ’∏÷Ä’∫’•’Ω ’Ω’•’≤’¥’∏÷Ç’¥
                return;
            }

            // ’ç’ø’∏÷Ç’£’•’¨, ’∏÷Ä ’Ω’•’≤’¥’∏÷Ç’¥’® ’π’´ ’•’≤’•’¨ ’Ø’∏’≤’°’µ’´’∂ ’¥’•’∂’µ’∏÷Ç’´ ’æ÷Ä’°
            if (event.clientX < 250) {
                return;
            }
            
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = - (event.clientY / window.innerHeight) * 2 + 1;

            raycaster.setFromCamera(mouse, camera);

            // ‘≤’∏’¨’∏÷Ä ÷Ö’¢’µ’•’Ø’ø’∂’•÷Ä’®, ’∏÷Ä’∏’∂÷Ñ ’Ø’°÷Ä’∏’≤ ’•’∂ ’Ω’•’≤’¥’æ’•’¨ (‘±÷Ä÷á + ’Ñ’∏’¨’∏÷Ä’°’Ø’∂’•÷Ä)
            const intersectableObjects = [sun, ...planetObjects.map(p => p.mesh)];
            const intersects = raycaster.intersectObjects(intersectableObjects);

            if (intersects.length > 0) {
                const clickedObject = intersects[0].object;
                const planetData = SOLAR_SYSTEM.find(p => p.name === clickedObject.name);

                if (planetData) {
                    infoTextEl.textContent = `${planetData.armenianName} (${planetData.name}): ‘≤’•’º’∂’æ’∏÷Ç’¥ ’ß ’ø’•’≤’•’Ø’°’ø’æ’∏÷Ç’©’µ’∏÷Ç’∂’®...`;
                    
                    // ’ì’∏÷Ñ÷Ä ’∏÷Ç’∑’°÷Å’∏÷Ç’¥, ’∏÷Ä’∫’•’Ω’¶’´ ÷Ö’£’ø’°’ø’•÷Ä’® ’ø’•’Ω’∂’´ ’∞’°’≤’∏÷Ä’§’°’£÷Ä’∏÷Ç’©’µ’∏÷Ç’∂’®
                    setTimeout(() => {
                        window.location.href = getAuthFilePath(planetData.link);
                    }, 50); 
                }
            } else {
                infoTextEl.textContent = '’ç’•’≤’¥’•÷Ñ ’¥’∏’¨’∏÷Ä’°’Ø’´ ’æ÷Ä’°’ù ’∞’•’ø÷Ñ÷Ä÷Ñ’´÷Ä ÷É’°’Ω’ø’•÷Ä ’´’¥’°’∂’°’¨’∏÷Ç ’∞’°’¥’°÷Ä÷â';
            }
        }

        // ‘∂’£’°’µ’∏÷Ç’∂ ’Ø’°’º’°’æ’°÷Ä’∏÷Ç’¥’∂’•÷Ä’® (Touch)
        function onTouchStart(event) {
             // ’â’©’∏÷Ç’µ’¨’°’ø÷Ä’•’¨ ’∫’ø’ø’•’¨, ’•’©’• ’Ω’Ø’Ω’•’¨ ’ß ’Ø’∏’≤’°’µ’´’∂ ’¥’•’∂’µ’∏÷Ç’´÷Å
            if (event.touches[0] && event.touches[0].clientX < 250) {
                return;
            }

            if (event.touches.length === 1) {
                // ’Ñ’•’Ø ’¥’°’ø’∏’æ ’∫’ø’ø’∏÷Ç’¥
                isDragging = true;
                previousMousePosition.x = event.touches[0].clientX;
                previousMousePosition.y = event.touches[0].clientY;
                initialPinchDistance = null;
            } else if (event.touches.length === 2) {
                // ‘µ÷Ä’Ø’∏÷Ç ’¥’°’ø’∏’æ ’¶’∏÷Ç’¥ (pinch)
                isDragging = false;
                const dx = event.touches[0].clientX - event.touches[1].clientX;
                const dy = event.touches[0].clientY - event.touches[1].clientY;
                initialPinchDistance = Math.sqrt(dx * dx + dy * dy);
            }
            event.preventDefault();
        }

        function onTouchMove(event) {
            if (event.touches.length === 2) {
                // **Pinch Zoom Logic - ‘≤‘±’ê‘µ‘º‘±’é’é‘±‘æ**
                if (initialPinchDistance === null) return;

                const dx = event.touches[0].clientX - event.touches[1].clientX;
                const dy = event.touches[0].clientY - event.touches[1].clientY;
                const currentPinchDistance = Math.sqrt(dx * dx + dy * dy);

                const deltaDistance = currentPinchDistance - initialPinchDistance;
                const zoomSpeed = 5; // ‘≤’°÷Ä’±÷Ä’°÷Å’∂’•’¨ ’¶’£’°’µ’∏÷Ç’∂’∏÷Ç’©’µ’∏÷Ç’∂’®

                camera.position.z -= deltaDistance / zoomSpeed; // ’Ä’°’Ø’°’º’°’Ø ’∏÷Ç’≤’≤’∏÷Ç’©’µ’∏÷Ç’∂, ’∏÷Ä’∫’•’Ω’¶’´ ’°’∑’≠’°’ø’´ ’´’∂’ø’∏÷Ç’´’ø’´’æ

                // Limit the zoom range
                camera.position.z = Math.max(5, Math.min(200, camera.position.z));

                initialPinchDistance = currentPinchDistance;

            } else if (isDragging && event.touches.length === 1) {
                // Single-finger rotation logic
                const deltaX = event.touches[0].clientX - previousMousePosition.x;
                const deltaY = event.touches[0].clientY - previousMousePosition.y;

                scene.rotation.y += deltaX * 0.005;
                scene.rotation.x += deltaY * 0.005;

                scene.rotation.x = Math.max(-Math.PI / 2, Math.min(Math.PI / 2, scene.rotation.x));

                previousMousePosition.x = event.touches[0].clientX;
                previousMousePosition.y = event.touches[0].clientY;
            }
            event.preventDefault();
        }

        function onTouchEnd(event) {
            if (event.touches.length === 0) {
                isDragging = false;
                initialPinchDistance = null;
            }
        }

        // ‘ø’°’∂’π’•’¨ init ÷Ü’∏÷Ç’∂’Ø÷Å’´’°’∂, ’•÷Ä’¢ ’∫’°’ø’∏÷Ç’∞’°’∂’® ’¢’•’º’∂’æ’´
        window.onload = init;
    </script>
</body>
</html>
